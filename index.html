<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal de Trainees FIEG</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para traduzir JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Estilos de Impressão -->
    <style>
        @media print {
            @page { 
                margin: 1cm; 
                size: landscape; 
            }
            
            body, html, #root { 
                height: auto !important; 
                overflow: visible !important; 
                background-color: white !important;
                color: black !important;
                padding-bottom: 2cm;
            }

            .print\:hidden { display: none !important; }
            .print\:block { display: block !important; }
            .print\:text-black { color: black !important; }
            .print\:text-slate-600 { color: #475569 !important; }
            .print\:shadow-none { box-shadow: none !important; }
            .print\:border-none { border: none !important; }
            .print\:break-inside-avoid { break-inside: avoid; }
            .print\:bg-transparent { background-color: transparent !important; }
            
            /* Forçar impressão exata de cores (backgrounds) */
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
            
            /* Bordas na tabela para o PDF */
            table { border-collapse: collapse !important; width: 100%; }
            th, td { 
                border: 1px solid #cbd5e1 !important; 
                padding: 8px !important;
            }
            th { background-color: #f1f5f9 !important; }
            
            /* Rodapé fixo */
            .print\:fixed-footer {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                border-top: 1px solid #ccc;
                padding: 10px;
                font-size: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 font-sans selection:bg-indigo-100">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // --- ÍCONES SVG (Substituindo dependência externa para evitar erros) ---
        const IconBase = ({ children, className, ...props }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width="24" 
                height="24" 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className} 
                {...props}
            >
                {children}
            </svg>
        );

        const Users = (props) => <IconBase {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconBase>;
        const UserPlus = (props) => <IconBase {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><line x1="19" x2="19" y1="8" y2="14"/><line x1="22" x2="16" y1="11" y2="11"/></IconBase>;
        const Search = (props) => <IconBase {...props}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></IconBase>;
        const Edit2 = (props) => <IconBase {...props}><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/></IconBase>;
        const TrendingUp = (props) => <IconBase {...props}><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></IconBase>;
        const Briefcase = (props) => <IconBase {...props}><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></IconBase>;
        const GraduationCap = (props) => <IconBase {...props}><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></IconBase>;
        const Building2 = (props) => <IconBase {...props}><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/></IconBase>;
        const X = (props) => <IconBase {...props}><path d="M18 6 6 18"/><path d="m6 6 18 18"/></IconBase>;
        const Printer = (props) => <IconBase {...props}><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></IconBase>;
        const FileText = (props) => <IconBase {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></IconBase>;
        const FileSpreadsheet = (props) => <IconBase {...props}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/></IconBase>;

        // --- DADOS INICIAIS ---
        const initialData = [
            // SESI
            { id: 1, entidade: 'SESI', unidade: 'Campinas', nome: 'Gabriel Rodrigues Masson', graduacao: 'Matemática', admissao: '19/02/24', status: 'Ativo', mentor: 'Jhenifer' },
            { id: 2, entidade: 'SESI', unidade: 'Campinas', nome: 'Gustavo Aguiar Magalhães', graduacao: 'Física', admissao: '08/01/24', status: 'Ativo', mentor: 'Angelo' },
            { id: 3, entidade: 'SESI', unidade: 'Campinas', nome: 'Haryta Ferreira Borges', graduacao: 'História', admissao: '08/05/24', status: 'Ativo', mentor: 'Thiago' },
            { id: 4, entidade: 'SESI', unidade: 'Canaã', nome: 'Iza Paula Gomes Fernandes', graduacao: 'Letras - Português', admissao: '05/09/24', status: 'Ativo', mentor: 'Daiane' },
            { id: 5, entidade: 'SESI', unidade: 'Canaã', nome: 'Larissa Kristy Coelho Costa', graduacao: 'Pedagogia', admissao: '08/01/24', status: 'Ativo', mentor: 'Daiane' },
            { id: 6, entidade: 'SESI', unidade: 'Canaã', nome: 'Meirielly Ribeiro', graduacao: 'Pedagogia', admissao: '15/08/24', status: 'Ativo', mentor: 'Daiane' },
            { id: 7, entidade: 'SESI', unidade: 'Canaã', nome: 'Emily Ellen Santos', graduacao: 'Pedagogia', admissao: '01/08/24', status: 'Contratado', mentor: 'Daiane' },
            { id: 8, entidade: 'SESI', unidade: 'Catalão', nome: 'Arthur Perdiz Franco Mesquita', graduacao: 'Ciências Biológicas', admissao: '08/01/24', status: 'Ativo', mentor: 'Andreia Julio' },
            { id: 9, entidade: 'SESI', unidade: 'Jaiara', nome: 'André Fillype Freitas Nascimento', graduacao: 'Ciências da Computação', admissao: '08/01/24', status: 'Ativo', mentor: 'Sandra' },
            { id: 10, entidade: 'SESI', unidade: 'Jundiaí', nome: 'Jennifer Cristine Dornas', graduacao: 'História', admissao: '07/08/24', status: 'Ativo', mentor: 'Lindaura' },
            { id: 11, entidade: 'SESI', unidade: 'Jundiaí', nome: 'Maria Luiza Flausino Pereira', graduacao: 'Química', admissao: '01/07/24', status: 'Encerrado', mentor: '-' },
            { id: 12, entidade: 'SESI', unidade: 'Planalto', nome: 'Adriel Silva França', graduacao: 'Educação Física', admissao: '08/07/24', status: 'Ativo', mentor: 'Junior' },
            { id: 13, entidade: 'SESI', unidade: 'Planalto', nome: 'Ana Clara Mehedin Silva Soares', graduacao: 'Pedagogia', admissao: '08/01/24', status: 'Contratado', mentor: 'Nicolas' },
            { id: 14, entidade: 'SESI', unidade: 'Planalto', nome: 'Gabriel Feitosa da Silva Ribeiro', graduacao: 'Matemática', admissao: '20/06/24', status: 'Ativo', mentor: 'Jaime' },
            { id: 15, entidade: 'SESI', unidade: 'Planalto', nome: 'Hanrry Patrick Viana de Paula', graduacao: 'Engenharia Mecânica', admissao: '08/01/24', status: 'Encerrado', mentor: 'Fernando' },
            { id: 16, entidade: 'SESI', unidade: 'Crixás', nome: 'Amanda Godinho dos Santos', graduacao: 'Pedagogia', admissao: '19/02/24', status: 'Contratado', mentor: '-' },
            { id: 17, entidade: 'SESI', unidade: 'Rio Verde', nome: 'Lucas Andrade Lima', graduacao: 'Engenharia de Software', admissao: '08/01/24', status: 'Ativo', mentor: 'Mariceu' },
            { id: 18, entidade: 'SESI', unidade: 'Itumbiara', nome: 'Mateus Divino Rodrigues Ferreira', graduacao: 'Matemática', admissao: '08/01/24', status: 'Encerrado', mentor: '-' },
            { id: 19, entidade: 'SESI', unidade: 'Rio Verde', nome: 'Maria Victória Ferreira Lopes', graduacao: 'Química', admissao: '06/03/25', status: 'Ativo', mentor: 'Mariceu' },
            { id: 20, entidade: 'SESI', unidade: 'Niquelândia', nome: 'Joaquim Pereira da Silva Junior', graduacao: '-', admissao: '19/02/24', status: 'Encerrado', mentor: '-' },
            { id: 21, entidade: 'SESI', unidade: 'Canaã', nome: 'Nikolle Alexandre Chaves', graduacao: 'Pedagogia', admissao: '15/07/25', status: 'Ativo', mentor: 'Maria Carolina' },
            { id: 22, entidade: 'SESI', unidade: 'Planalto', nome: 'Rafaella Nunes de Sousa', graduacao: '-', admissao: '09/06/25', status: 'Ativo', mentor: '-' },
            { id: 23, entidade: 'SESI', unidade: 'Planalto', nome: 'José Gustavo Santana de Oliveira', graduacao: '-', admissao: '04/09/25', status: 'Ativo', mentor: '-' },
            { id: 24, entidade: 'SESI', unidade: 'Canaã', nome: 'Ana Julia de Almeida Pereira', graduacao: '-', admissao: '15/09/25', status: 'Ativo', mentor: '-' },
            { id: 25, entidade: 'SESI', unidade: 'Colorado', nome: 'Sarah de Jesus Martins', graduacao: '-', admissao: '09/09/25', status: 'Ativo', mentor: '-' },
            
            // SENAI
            { id: 26, entidade: 'SENAI', unidade: 'Canaã', nome: 'Gabriel Rodrigues de Morais', graduacao: 'Física Médica', admissao: '19/02/24', status: 'Encerrado', mentor: '-' },
            { id: 27, entidade: 'SENAI', unidade: 'Catalão', nome: 'Alexandre Ferreira de Carvalho', graduacao: 'Engenharia Mecânica', admissao: '09/08/24', status: 'Ativo', mentor: 'Leonardo Pereira' },
            { id: 28, entidade: 'SENAI', unidade: 'Catalão', nome: 'Maria Luiza Carneiro', graduacao: 'Engenharia Civil', admissao: '09/08/24', status: 'Encerrado', mentor: '-' },
            { id: 29, entidade: 'SENAI', unidade: 'Catalão', nome: 'Yuri Silvério Calaça Camargo', graduacao: 'Ciências da Computação', admissao: '17/07/24', status: 'Ativo', mentor: 'Leonardo' },
            { id: 30, entidade: 'SENAI', unidade: 'Charuri', nome: 'Marcos Henrique Rodrigues Porto', graduacao: 'Engenharia Elétrica', admissao: '08/01/24', status: 'Encerrado', mentor: '-' },
            { id: 31, entidade: 'SENAI', unidade: 'Colorado', nome: 'Esthefany Duarte Dias', graduacao: 'Engenharia Civil', admissao: '01/08/24', status: 'Ativo', mentor: 'Fabio' },
            { id: 32, entidade: 'SENAI', unidade: 'Colorado', nome: 'Barbara Xavier Alves', graduacao: 'Engenharia de Produção', admissao: '02/09/24', status: 'Ativo', mentor: 'Fabio' },
            { id: 33, entidade: 'SENAI', unidade: 'Fatesg', nome: 'Daniel Tadashi Waki', graduacao: 'Análise de Sistemas', admissao: '01/08/24', status: 'Ativo', mentor: 'Eduardo' },
            { id: 34, entidade: 'SENAI', unidade: 'Fatesg', nome: 'Luiz Gustavo Rocha dos Santos', graduacao: 'Engenharia de Software', admissao: '02/09/24', status: 'Ativo', mentor: 'Eduardo' },
            { id: 35, entidade: 'SENAI', unidade: 'IB', nome: 'Alanna Pereira Nunes', graduacao: 'Engenharia Elétrica', admissao: '19/06/24', status: 'Encerrado', mentor: 'Virgílio' },
            { id: 36, entidade: 'SENAI', unidade: 'IB', nome: 'Raul Cardoso Nascimento', graduacao: 'Engenharia Mecânica', admissao: '08/01/24', status: 'Encerrado', mentor: '-' },
            { id: 37, entidade: 'SENAI', unidade: 'Itumbiara', nome: 'Maria Eduarda Silva Ferreira', graduacao: 'Biomedicina', admissao: '-', status: 'Encerrado', mentor: '-' },
            { id: 38, entidade: 'SENAI', unidade: 'RM', nome: 'Carlos Eduardo Cardoso Silvestre', graduacao: 'Ciências da Computação', admissao: '17/04/24', status: 'Contratado', mentor: '-' },
            { id: 39, entidade: 'SENAI', unidade: 'RM', nome: 'Vinicius Rodrigues Martins', graduacao: 'Engenharia de Software', admissao: '18/03/24', status: 'Encerrado', mentor: '-' },
            { id: 40, entidade: 'SENAI', unidade: 'RM', nome: 'Weverton da Cruz Montalvão', graduacao: 'Engenharia Elétrica', admissao: '08/01/24', status: 'Contratado', mentor: '-' },
            { id: 41, entidade: 'SENAI', unidade: 'Rio Verde', nome: 'Danilo Augusto Rodrigues', graduacao: 'Engenharia Mecânica', admissao: '19/02/24', status: 'Ativo', mentor: 'Petteson' },
            { id: 42, entidade: 'SENAI', unidade: 'Niquelândia', nome: 'Junio Cândido Teixeira', graduacao: 'Engenharia Civil', admissao: '08/04/24', status: 'Contratado', mentor: '-' },
            { id: 43, entidade: 'SENAI', unidade: 'Niquelândia', nome: 'Talita Tayane Luiz de Oliveira', graduacao: 'Administração', admissao: '13/09/24', status: 'Contratado', mentor: '-' },
            { id: 44, entidade: 'SENAI', unidade: 'Canaã', nome: 'Fablicio Cesar Lima Valadão', graduacao: 'Engenharia Elétrica', admissao: '19/02/24', status: 'Ativo', mentor: 'Juan' },
            { id: 45, entidade: 'SENAI', unidade: 'Canaã', nome: 'Marcos Denner Araújo Lima', graduacao: 'Publicidade Propaganda', admissao: '17/10/24', status: 'Ativo', mentor: 'Gustavo' },
            { id: 46, entidade: 'SENAI', unidade: 'Aparecida', nome: 'Debora Melo de Andrade', graduacao: 'Biomedicina', admissao: '12/08/24', status: 'Ativo', mentor: 'Tatiana' },
            { id: 47, entidade: 'SENAI', unidade: 'RM', nome: 'Audrey Pereira Lacerda', graduacao: 'Engenharia de software', admissao: '05/03/25', status: 'Ativo', mentor: 'Vinicius' },
            { id: 48, entidade: 'SENAI', unidade: 'UDIGI', nome: 'Alex Pierre Ribeiro de Moraes', graduacao: 'Engenharia de software', admissao: '10/02/25', status: 'Ativo', mentor: 'Elson' },
            { id: 49, entidade: 'SENAI', unidade: 'IB', nome: 'Matheus Macedo de Souza', graduacao: '-', admissao: '08/01/24', status: 'Encerrado', mentor: '-' },
            { id: 50, entidade: 'SENAI', unidade: 'Catalão', nome: 'Pedro Anthonny Mendes Macedo', graduacao: '-', admissao: '08/01/24', status: 'Encerrado', mentor: '-' },
            { id: 51, entidade: 'SENAI', unidade: 'Catalão', nome: 'Pedro Henrique de Araújo', graduacao: 'Engenharia de Produção', admissao: '04/08/25', status: 'Encerrado', mentor: 'Leonardo' },
            { id: 52, entidade: 'SENAI', unidade: 'Catalão', nome: 'Amanda Marques Vieira', graduacao: 'Engenharia de Minas', admissao: '01/09/25', status: 'Encerrado', mentor: 'Leonardo' },
            { id: 53, entidade: 'SENAI', unidade: 'Charuri', nome: 'Mylena de Paula Oliveira Faria', graduacao: 'Análise e Des. De Sistemas', admissao: '02/09/25', status: 'Encerrado', mentor: 'Joyce' },
        ];

        // --- COMPONENTES UI ---

        const MetricCard = ({ title, value, icon: Icon, colorClass, subtext }) => (
            <div className="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 transition-all relative overflow-hidden group print:shadow-none print:border print:border-slate-300 print:break-inside-avoid">
                <div className="flex items-start justify-between relative z-10">
                    <div>
                        <p className="text-sm font-medium text-slate-500 uppercase tracking-wider print:text-black">{title}</p>
                        <h3 className="text-3xl font-bold text-slate-800 mt-2 print:text-black">{value}</h3>
                        {subtext && <p className="text-xs text-slate-400 mt-1 print:text-slate-600">{subtext}</p>}
                    </div>
                    <div className={`p-3 rounded-xl transition-transform ${colorClass} print:bg-transparent print:border print:border-slate-200`}>
                        <Icon className="w-6 h-6 text-white print:text-black" />
                    </div>
                </div>
            </div>
        );

        const StatusBadge = ({ status }) => {
            const styles = {
                'Ativo': 'bg-emerald-100 text-emerald-800 border-emerald-200',
                'Contratado': 'bg-blue-100 text-blue-800 border-blue-200',
                'Contratada': 'bg-blue-100 text-blue-800 border-blue-200',
                'Encerrado': 'bg-slate-100 text-slate-600 border-slate-200',
            };

            const defaultStyle = 'bg-gray-100 text-gray-800';
            const normalizedStatus = status === 'Contratada' ? 'Contratado' : status;

            return (
                <span className={`px-3 py-1 rounded-full text-xs font-semibold border print:border-slate-400 print:text-black print:bg-transparent ${styles[status] || defaultStyle}`}>
                    {normalizedStatus}
                </span>
            );
        };

        function App() {
            const [collaborators, setCollaborators] = useState(initialData);
            const [searchTerm, setSearchTerm] = useState('');
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [currentCollaborator, setCurrentCollaborator] = useState(null);

            // Estados de Filtro
            const [filterEntidade, setFilterEntidade] = useState('Todas');
            const [filterUnidade, setFilterUnidade] = useState('Todas');
            const [filterGraduacao, setFilterGraduacao] = useState('Todas');
            const [filterStatus, setFilterStatus] = useState('Todos');

            // Estados do Formulário
            const [formData, setFormData] = useState({
                nome: '', entidade: 'SESI', unidade: '', graduacao: '', admissao: '', status: 'Ativo', mentor: ''
            });

            // --- LÓGICA DE DADOS ---
            const uniqueEntidades = useMemo(() => ['Todas', ...new Set(collaborators.map(c => c.entidade).filter(Boolean).sort())], [collaborators]);
            const uniqueUnidades = useMemo(() => ['Todas', ...new Set(collaborators.map(c => c.unidade).filter(Boolean).sort())], [collaborators]);
            const uniqueGraduacoes = useMemo(() => ['Todas', ...new Set(collaborators.map(c => c.graduacao).filter(Boolean).sort())], [collaborators]);

            const filteredCollaborators = useMemo(() => {
                return collaborators.filter(colab => {
                    const matchesSearch = colab.nome.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                          colab.unidade.toLowerCase().includes(searchTerm.toLowerCase()) ||
                                          colab.graduacao.toLowerCase().includes(searchTerm.toLowerCase());
                    
                    const matchesEntidade = filterEntidade === 'Todas' || colab.entidade === filterEntidade;
                    const matchesUnidade = filterUnidade === 'Todas' || colab.unidade === filterUnidade;
                    const matchesGraduacao = filterGraduacao === 'Todas' || colab.graduacao === filterGraduacao;

                    const matchesStatus = filterStatus === 'Todos' || 
                                          (filterStatus === 'Contratado' ? (colab.status === 'Contratado' || colab.status === 'Contratada') : colab.status === filterStatus);

                    return matchesSearch && matchesEntidade && matchesUnidade && matchesGraduacao && matchesStatus;
                });
            }, [collaborators, searchTerm, filterEntidade, filterUnidade, filterGraduacao, filterStatus]);

            const stats = useMemo(() => {
                return {
                    total: filteredCollaborators.length,
                    sesi: filteredCollaborators.filter(c => c.entidade === 'SESI').length,
                    senai: filteredCollaborators.filter(c => c.entidade === 'SENAI').length,
                    ativos: filteredCollaborators.filter(c => c.status === 'Ativo').length,
                    contratados: filteredCollaborators.filter(c => c.status === 'Contratado' || c.status === 'Contratada').length,
                };
            }, [filteredCollaborators]);

            // --- HANDLERS ---
            const handleOpenModal = (collaborator = null) => {
                if (collaborator) {
                    setFormData(collaborator);
                    setCurrentCollaborator(collaborator);
                } else {
                    setFormData({ nome: '', entidade: 'SESI', unidade: '', graduacao: '', admissao: '', status: 'Ativo', mentor: '' });
                    setCurrentCollaborator(null);
                }
                setIsModalOpen(true);
            };

            const handleSave = (e) => {
                e.preventDefault();
                if (currentCollaborator) {
                    setCollaborators(prev => prev.map(c => c.id === currentCollaborator.id ? { ...formData, id: c.id } : c));
                } else {
                    const newId = Math.max(...collaborators.map(c => c.id), 0) + 1;
                    setCollaborators(prev => [...prev, { ...formData, id: newId }]);
                }
                setIsModalOpen(false);
            };

            const handlePrint = () => { window.print(); };

            const handleExportExcel = () => {
                const tableContent = `
                    <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">
                    <head>
                        <meta charset="utf-8" />
                        <style>
                            table { border-collapse: collapse; width: 100%; }
                            th, td { border: 1px solid #000000; padding: 5px; text-align: left; }
                            th { background-color: #f2f2f2; font-weight: bold; }
                        </style>
                    </head>
                    <body>
                        <table>
                            <thead>
                                <tr>
                                    <th>Nome</th><th>Entidade</th><th>Unidade</th><th>Graduação</th><th>Admissão</th><th>Status</th><th>Mentor</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${filteredCollaborators.map(c => `
                                    <tr>
                                        <td>${c.nome}</td><td>${c.entidade}</td><td>${c.unidade}</td><td>${c.graduacao}</td><td>${c.admissao}</td><td>${c.status}</td><td>${c.mentor}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </body>
                    </html>
                `;
                const blob = new Blob([tableContent], { type: 'application/vnd.ms-excel' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.setAttribute('download', `relatorio_trainees_${new Date().toISOString().slice(0,10)}.xls`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            return (
                <div className="min-h-screen pb-20 print:pb-0">
                    <header className="bg-white border-b border-slate-200 sticky top-0 z-20 print:hidden">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <div className="bg-indigo-600 p-2 rounded-lg">
                                    <Users className="w-6 h-6 text-white" />
                                </div>
                                <h1 className="text-xl font-bold tracking-tight text-slate-900">Portal de Trainees</h1>
                            </div>
                            <div className="flex items-center gap-4">
                                <button onClick={handleExportExcel} className="flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm">
                                    <FileSpreadsheet className="w-4 h-4" />
                                    <span className="hidden sm:inline">Gerar Excel</span>
                                </button>
                                <button onClick={handlePrint} className="flex items-center gap-2 bg-slate-800 hover:bg-slate-900 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors shadow-sm">
                                    <FileText className="w-4 h-4" />
                                    <span className="hidden sm:inline">Gerar PDF</span>
                                </button>
                                <div className="h-8 w-8 rounded-full bg-slate-200 border border-slate-300 flex items-center justify-center">
                                    <span className="text-xs font-bold text-slate-600">AD</span>
                                </div>
                            </div>
                        </div>
                    </header>

                    <div className="hidden print:block mb-6 text-center border-b pb-4 pt-4">
                        <h1 className="text-2xl font-bold text-black">Relatório de Profissionais</h1>
                        <p className="text-sm text-slate-600">
                            Filtros Aplicados: {filterEntidade} | {filterUnidade} | Status: {filterStatus}
                        </p>
                    </div>

                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8 print:p-0 print:w-full print:max-w-none">
                        <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
                            <MetricCard title="Total Listado" value={stats.total} icon={Users} colorClass="bg-indigo-600" />
                            <MetricCard title="SESI" value={stats.sesi} icon={Building2} colorClass="bg-green-600" subtext="Colaboradores SESI" />
                            <MetricCard title="SENAI" value={stats.senai} icon={Building2} colorClass="bg-orange-500" subtext="Colaboradores SENAI" />
                            <MetricCard title="Em Programa" value={stats.ativos} icon={TrendingUp} colorClass="bg-emerald-500" subtext="Ativos" />
                            <MetricCard title="Contratados" value={stats.contratados} icon={Briefcase} colorClass="bg-purple-500" subtext="Efetivados" />
                        </div>

                        <div className="flex flex-col gap-4 p-4 rounded-xl border border-slate-200 bg-white shadow-sm transition-colors print:hidden">
                            <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                                <div className="relative w-full sm:w-96">
                                    <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <Search className="h-5 w-5 text-slate-400" />
                                    </div>
                                    <input type="text" placeholder="Buscar por nome..." className="pl-10 w-full rounded-lg text-sm focus:ring-indigo-500 focus:border-indigo-500 py-2.5 transition-colors border-slate-200 bg-slate-50" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} />
                                </div>
                                <div className="flex items-center gap-2 w-full sm:w-auto overflow-x-auto pb-1 sm:pb-0">
                                    <div className="flex items-center rounded-lg p-1 border flex-nowrap bg-slate-50 border-slate-200">
                                        {['Todos', 'Ativo', 'Contratado', 'Encerrado'].map((status) => (
                                            <button key={status} onClick={() => setFilterStatus(status)} className={`px-3 py-1.5 text-xs font-medium rounded-md whitespace-nowrap transition-all ${filterStatus === status ? 'bg-white text-indigo-700 shadow-sm border border-slate-100' : 'text-slate-500 hover:text-slate-700'}`}>{status}</button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                            <div className="flex flex-col md:flex-row gap-4 items-end md:items-center justify-between border-t border-slate-100 pt-4">
                                <div className="flex flex-col sm:flex-row gap-2 w-full md:w-auto">
                                    <div className="flex flex-col w-full sm:w-32">
                                        <label className="text-xs font-semibold text-slate-500 mb-1">Entidade</label>
                                        <select className="rounded-lg border-slate-200 text-sm py-2 bg-slate-50 focus:ring-indigo-500 focus:border-indigo-500" value={filterEntidade} onChange={(e) => setFilterEntidade(e.target.value)}>
                                            {uniqueEntidades.map(u => <option key={u} value={u}>{u}</option>)}
                                        </select>
                                    </div>
                                    <div className="flex flex-col w-full sm:w-40">
                                        <label className="text-xs font-semibold text-slate-500 mb-1">Unidade</label>
                                        <select className="rounded-lg border-slate-200 text-sm py-2 bg-slate-50 focus:ring-indigo-500 focus:border-indigo-500" value={filterUnidade} onChange={(e) => setFilterUnidade(e.target.value)}>
                                            {uniqueUnidades.map(u => <option key={u} value={u}>{u}</option>)}
                                        </select>
                                    </div>
                                    <div className="flex flex-col w-full sm:w-48">
                                        <label className="text-xs font-semibold text-slate-500 mb-1">Formação</label>
                                        <select className="rounded-lg border-slate-200 text-sm py-2 bg-slate-50 focus:ring-indigo-500 focus:border-indigo-500" value={filterGraduacao} onChange={(e) => setFilterGraduacao(e.target.value)}>
                                            {uniqueGraduacoes.map(u => <option key={u} value={u}>{u.length > 25 ? u.substring(0, 25) + '...' : u}</option>)}
                                        </select>
                                    </div>
                                </div>
                                <div className="flex gap-2">
                                    <button onClick={() => handleOpenModal()} className="flex items-center gap-2 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2.5 rounded-lg text-sm font-medium transition-colors shadow-sm whitespace-nowrap">
                                        <UserPlus className="w-4 h-4" />
                                        <span>Novo Profissional</span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden print:shadow-none print:border-none print:rounded-none">
                            <div className="overflow-x-auto">
                                <table className="w-full text-left border-collapse">
                                    <thead>
                                        <tr className="bg-slate-50 border-b border-slate-200 print:bg-white print:border-black">
                                            <th className="px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider print:text-black">Profissional</th>
                                            <th className="px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider print:text-black">Entidade / Unidade</th>
                                            <th className="px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider print:text-black">Formação</th>
                                            <th className="px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider print:text-black">Status</th>
                                            <th className="px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider print:text-black">Mentor</th>
                                            <th className="px-6 py-4 text-xs font-semibold text-slate-500 uppercase tracking-wider text-right print:hidden">Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-slate-100 print:divide-slate-200">
                                        {filteredCollaborators.length > 0 ? (
                                            filteredCollaborators.map((item) => (
                                                <tr key={item.id} className="hover:bg-slate-50 transition-colors group print:hover:bg-transparent break-inside-avoid">
                                                    <td className="px-6 py-4">
                                                        <div className="flex items-center gap-3">
                                                            <div className="h-10 w-10 rounded-full flex items-center justify-center font-bold text-sm border bg-indigo-50 text-indigo-600 border-indigo-100 print:hidden">
                                                                {item.nome.charAt(0)}{item.nome.split(' ').pop().charAt(0)}
                                                            </div>
                                                            <div>
                                                                <p className="text-sm font-semibold text-slate-900">{item.nome}</p>
                                                                <p className="text-xs text-slate-500 print:text-black">Admissão: {item.admissao}</p>
                                                            </div>
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div className="flex flex-col">
                                                            <span className={`text-xs font-bold w-fit px-1.5 py-0.5 rounded mb-1 print:border print:border-black print:bg-transparent print:text-black ${item.entidade === 'SESI' ? 'bg-green-50 text-green-700' : 'bg-orange-50 text-orange-700'}`}>
                                                                {item.entidade}
                                                            </span>
                                                            <span className="text-sm text-slate-600 print:text-black">{item.unidade}</span>
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <div className="flex items-center gap-2">
                                                            <GraduationCap className="w-4 h-4 text-slate-400 print:hidden" />
                                                            <span className="text-sm text-slate-700 print:text-black">{item.graduacao || '-'}</span>
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <StatusBadge status={item.status} />
                                                    </td>
                                                    <td className="px-6 py-4">
                                                        <span className="text-sm text-slate-600 print:text-black">{item.mentor || '-'}</span>
                                                    </td>
                                                    <td className="px-6 py-4 text-right print:hidden">
                                                        <button onClick={() => handleOpenModal(item)} className="p-1.5 text-slate-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors" title="Editar">
                                                            <Edit2 className="w-4 h-4" />
                                                        </button>
                                                    </td>
                                                </tr>
                                            ))
                                        ) : (
                                            <tr>
                                                <td colSpan="6" className="px-6 py-12 text-center text-slate-400">
                                                    <div className="flex flex-col items-center gap-2">
                                                        <Search className="w-8 h-8 opacity-50" />
                                                        <p>Nenhum profissional encontrado.</p>
                                                    </div>
                                                </td>
                                            </tr>
                                        )}
                                    </tbody>
                                </table>
                            </div>
                            <div className="bg-slate-50 px-6 py-3 border-t border-slate-200 flex justify-between items-center text-xs text-slate-500 print:hidden">
                                <span>Mostrando {filteredCollaborators.length} registros</span>
                                <span>Dados atualizados do sistema</span>
                            </div>
                        </div>
                    </main>

                    <div className="hidden print:fixed-footer">
                        <div className="flex justify-between items-center w-full max-w-7xl mx-auto px-4">
                            <span>Sistema de Gestão de Trainees - FIEG</span>
                            <span>Relatório gerado em: {new Date().toLocaleString()}</span>
                        </div>
                    </div>

                    {/* Modal Form */}
                    {isModalOpen && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center bg-slate-900/50 backdrop-blur-sm p-4 print:hidden">
                            <div className="bg-white rounded-2xl shadow-xl w-full max-w-lg border border-slate-200">
                                <div className="flex items-center justify-between px-6 py-4 border-b border-slate-100">
                                    <h2 className="text-lg font-bold text-slate-900">
                                        {currentCollaborator ? 'Editar Profissional' : 'Novo Profissional'}
                                    </h2>
                                    <button onClick={() => setIsModalOpen(false)} className="text-slate-400 hover:text-slate-600 hover:bg-slate-100 p-1 rounded-full transition-colors">
                                        <X className="w-5 h-5" />
                                    </button>
                                </div>
                                <form onSubmit={handleSave} className="p-6 space-y-4">
                                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                        <div className="col-span-1 sm:col-span-2">
                                            <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1">Nome Completo</label>
                                            <input required type="text" className="w-full rounded-lg border-slate-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2.5" value={formData.nome} onChange={e => setFormData({...formData, nome: e.target.value})} />
                                        </div>
                                        <div>
                                            <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1">Entidade</label>
                                            <select className="w-full rounded-lg border-slate-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2.5" value={formData.entidade} onChange={e => setFormData({...formData, entidade: e.target.value})}>
                                                <option value="SESI">SESI</option>
                                                <option value="SENAI">SENAI</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1">Unidade</label>
                                            <input type="text" className="w-full rounded-lg border-slate-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2.5" value={formData.unidade} onChange={e => setFormData({...formData, unidade: e.target.value})} />
                                        </div>
                                        <div className="col-span-1 sm:col-span-2">
                                            <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1">Graduação</label>
                                            <input type="text" className="w-full rounded-lg border-slate-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2.5" value={formData.graduacao} onChange={e => setFormData({...formData, graduacao: e.target.value})} />
                                        </div>
                                        <div>
                                            <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1">Data Admissão</label>
                                            <input type="text" placeholder="dd/mm/aaaa" className="w-full rounded-lg border-slate-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2.5" value={formData.admissao} onChange={e => setFormData({...formData, admissao: e.target.value})} />
                                        </div>
                                        <div>
                                            <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1">Status</label>
                                            <select className="w-full rounded-lg border-slate-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2.5" value={formData.status} onChange={e => setFormData({...formData, status: e.target.value})}>
                                                <option value="Ativo">Ativo</option>
                                                <option value="Contratado">Contratado</option>
                                                <option value="Encerrado">Encerrado</option>
                                            </select>
                                        </div>
                                        <div className="col-span-1 sm:col-span-2">
                                            <label className="block text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1">Mentor</label>
                                            <input type="text" className="w-full rounded-lg border-slate-300 focus:border-indigo-500 focus:ring-indigo-500 text-sm py-2.5" value={formData.mentor} onChange={e => setFormData({...formData, mentor: e.target.value})} />
                                        </div>
                                    </div>
                                    <div className="flex gap-3 pt-4 border-t border-slate-100 mt-6">
                                        <button type="button" onClick={() => setIsModalOpen(false)} className="flex-1 px-4 py-2.5 text-sm font-semibold text-slate-700 bg-slate-100 hover:bg-slate-200 rounded-lg transition-colors">Cancelar</button>
                                        <button type="submit" className="flex-1 px-4 py-2.5 text-sm font-semibold text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg shadow-sm transition-colors">Salvar Dados</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
